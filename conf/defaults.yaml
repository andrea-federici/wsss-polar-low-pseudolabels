## HARDWARE ##
hardware:
  device: cuda
  accelerator: gpu
  devices: 1

## LOGGER ##
neptune:
  project: 'andreaf/polarlows'
  api_key: ${oc.env:NEPTUNE_API_TOKEN}

## DATA ##
data_dir: data

## MISC ##
# Enable Tensor Cores for faster matrix multiplications, trading some 
# precision for performance.
# - 'high' gives the best speed-up but with reduced precision.
# - 'medium' balances precision and performance.
# - 'highest' (default) maintains full precision but may be slower.
matmul_precision: medium
num_workers: 16

## MODEL ##
torch_model: xception
num_classes: 2

## LOSS AND OPTIMIZER ##
criterion: cross_entropy
optimizer: adam

## TRAINING ##
batch_size: 16
max_epochs: 100
learning_rate: 5e-4

## CALLBACKS ##

# Early stopping
early_stopping:
  patience: 10

# Checkpoint
checkpoint:
  directory: checkpoints
  filename: best-checkpoint

# Learning rate scheduler
lr_scheduler:
  name: reduce_lr_on_plateau
  monitor: val_loss
  mode: min
  patience: 5
  factor: 0.5