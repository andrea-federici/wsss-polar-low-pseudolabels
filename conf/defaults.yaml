## HARDWARE ##
hardware:
  device: cuda
  accelerator: gpu
  devices: 1

## LOGGER ##
neptune:
  project: 'andreaf/polarlows'
  api_key: ${oc.env:NEPTUNE_API_TOKEN}

## DATA ##
data_dir: data

## TRANSFORMS ##
transforms:
  image_width: 500
  image_height: 500

  normalization:
    mean: [0.2872, 0.2872, 0.4595]
    std: [0.1806, 0.1806, 0.2621]

  augmentation:
    translate_frac: [0.4, 0.4] # Using Optuna, the best value was found to be 0.4113
    degrees: 20
    scale: [0.9, 1.1]
    horizontal_flip: true
    vertical_flip: true

## MISC ##
# Enable Tensor Cores for faster matrix multiplications, trading some 
# precision for performance.
# - 'high' gives the best speed-up but with reduced precision.
# - 'medium' balances precision and performance.
# - 'highest' (default) maintains full precision but may be slower.
matmul_precision: medium
num_workers: 16

## MODEL ##
torch_model: xception
num_classes: 2

## LOSS AND OPTIMIZER ##
criterion: cross_entropy
optimizer: adam

## TRAINING ##
batch_size: 16
max_epochs: 100
learning_rate: 5e-4

## CALLBACKS ##

# Early stopping
early_stopping:
  patience: 10

# Checkpoint
checkpoint:
  directory: out/checkpoints
  filename: best-checkpoint

# Learning rate scheduler
lr_scheduler:
  name: reduce_lr_on_plateau
  monitor: val_loss
  mode: min
  patience: 5
  factor: 0.5